(function(){(function(){return $(function(){var j,a,c,d,f,e,h,b,i,g;b={};$(".filterDD").getBySelect();j=$("#resultModal");e=$("#ScreeningsResultsTable");g=abp.services.app.screening;i={create:abp.auth.hasPermission("Pages.Administration.Companies.Create"),edit:abp.auth.hasPermission("Pages.Administration.Companies.Edit"),list:abp.auth.hasPermission("Pages.Administration.Companies"),"delete":abp.auth.hasPermission("Pages.Administration.Companies.Delete")};h=new app.ModalManager({viewUrl:abp.appPath+"Mpa/Users/CreateOrEditModal",scriptUrl:abp.appPath+"Areas/Mpa/Views/Users/_CreateOrEditModal.js",modalClass:"CreateOrEditUserModal"});f=new app.ModalManager({viewUrl:abp.appPath+"Mpa/Users/PermissionsModal",scriptUrl:abp.appPath+"Areas/Mpa/Views/Users/_PermissionsModal.js",modalClass:"UserPermissionsModal"});e.jtable({title:app.localize("Screenings"),paging:true,sorting:true,multiSorting:false,actions:{listAction:{method:g.screeningsResults}},fields:{id:{key:true,sort:false,title:"#",width:"1%"},dateTime:{title:app.localize("DateTime"),width:"10%",display:function(m){var l,k,n;l=new Date(m.record.dateTime);k=l.toLocaleDateString();n=l.toLocaleTimeString().replace(/\:\d{2}\ /," ");return""+k+"</br>"+n}},account:{title:app.localize("Account"),width:"10%"},patient:{title:app.localize("Patient"),width:"20%",display:function(k){return k.record.patient.fullName}},clinician:{title:app.localize("Clinician"),width:"20%"},payor:{title:app.localize("Payor"),width:"10%",display:function(k){return k.record.patient.payor}},screening:{title:app.localize("Screening"),width:"10%",display:function(k){return k.record.typeScreening.type}},cost:{title:app.localize("Cost"),width:"10%"},totalScore:{title:app.localize("TotalScore"),width:"2%",display:function(m){var l,k;l=m.record.resultRed;k=l==="Yellow"?"color: black; ":" ";return $("<div class='circle score-circle' style='background-color: "+l+"; "+k+"'>"+m.record.totalScore+"</div>")}},result:{title:app.localize("Result"),width:"1%",display:function(n){var k,p,l,m,o;k=$('<div style="width:130px;"></div>');m=(function(){switch(n.record.resultRed){case"Green":return"success";case"Yellow":return"warning";case"Red":return"danger";default:return"default"}})();o=""+n.record.patient.fullName+" / "+n.record.typeScreening.type+" / "+n.record.totalScore;$("<button class='btn btn-default btn-xs _actionButton' title='View' type='button' data-action='modal' aria-label='Left Align' data-id='"+n.record.id+"' data-title='"+o+"' data-style='"+m+"'> <span class='glyphicon glyphicon-modal-window' aria-hidden='true'></span> View </button>").appendTo(k);l=n.record.reports;p;if(typeof l!=="undefined"&&l.length>0){p=$('<a class="btn btn-default btn-xs" title="PDF" target="_blank" href="'+l[l.length-1].url+'">PDF</a>')}else{p=$('<a class="btn btn-default btn-xs" title="PDF" target="_blank" href="#">PDF</a>')}p.appendTo(k).click(function(){});return k}}}});a=function(k){if(k){return e.jtable("reload")}else{return e.jtable("load",b)}};abp.event.on("app.createOrEditUserModalSaved",function(){return getCompanies(true)});a();d=function(n,m,k){var l;j.find(".modal-content").addClass("panel-"+k).data("style",k).end().find(".modal-title").html(m).end().modal("show");l=$("<div></div>");return g.getAllFullScreening({id:n}).then(function(u){var p,y,x,r,v,s,q,w,o,t;v=u.typeScreening.questions;for(s=0,w=v.length;s<w;s++){r=v[s];$("</br><h4>"+r.questionStr+"</h4>").appendTo(l);t=r.answers;for(q=0,o=t.length;q<o;q++){y=t[q];x=y.select?"checked":"";p=$("<div class='radio disabled'> <label> <input type='radio' name='answer_"+y.id+"' id='optionsRadios3' value='option3' disabled "+x+"> "+y.optionStr+" </label> </div>");p.appendTo(l)}}return j.find(".progress").fadeOut().end().find("#result").html(l).fadeIn()})};$("body").on("click","._actionButton",function(o){var m,l,q,k,n,p;m=$(o.currentTarget).data("action");switch(m){case"dateFilter":n=$(o.currentTarget);if(n.hasClass("active")){n.removeClass("active");l=void 0}else{$("._actionButton.active").removeClass("active");n.addClass("active");l=o.currentTarget.dataset.filter}b.dateFilter=l;c();return a();case"modal":q=o.currentTarget.dataset.id;p=o.currentTarget.dataset.title;k=o.currentTarget.dataset.style;return d(q,p,k)}});$("#searchButton").on("click",function(){c();return a()});c=function(){var k;k={practice:$("#filterPractice").val()||void 0,screening:$("#filterScreening").val()||void 0,name:$("#filterName").val()||void 0,start:$("#filterStart").val()||void 0,end:$("#filterEnd").val()||void 0};return Object.assign(b,k)};return j.on("hidden.bs.modal",function(k){return j.find(".modal-content").removeClass(function(){return"panel-"+$(this).data("style")}).end().find("#result").hide().end().find(".progress").show()})})})()}).call(this);