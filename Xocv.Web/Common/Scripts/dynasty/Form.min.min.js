(function(){window.Form=(function(){function b(a){this._Filters={};this._Table={};this._Service=a.service;this.jtable=a.jtable;this.$Table=$(a.table);this.$filterForm=$(a.filterForm);this.$Modal=$(a.modal);this._FormField=a.formField;this.sFormClean=a.formClean;this.$saveButton=$(a.saveButton)}b.prototype.init=function(a){this.$Table.jtable(this.jtable);return this.getList()};b.prototype.getList=function(){return this.$Table.jtable("load",this._Filters)};b.prototype.resetList=function(){return this.$Table.jtable("load",{})};b.prototype.updateList=function(){return this.$Table.jtable("reload")};b.prototype.getFilters=function(){var a;a={OrganisationUnitId:$("#filterClinicianId").val()||void 0,filterName:$("#filterName").val()||void 0,filterSecurity:$("#filterSecurity").val()||void 0,filterGender:$("#filterGender").val()||void 0,filterLanguage:$("#filterLanguage").val()||void 0,filterPayor:$("#filterPayor").val()||void 0};return Object.assign(this._Filters,a)};b.prototype.fillForm=function(h){var k,i,j,a,l;k=this._Table[h]||{};a=this._FormField;for(i in a){j=a[i];l=k[i];if(typeof j==="string"){$(j).val(l||"")}if(typeof j==="object"){if(j.element){$(j.element).val(l||"")}if(j.set){j.set(l,i,k)}}}return this.$saveButton.find(".btnText").text(app.localize("Save"))};b.prototype.getForm=function(j){var i,g,h,a;i={};a=this._FormField;for(g in a){h=a[g];if(typeof h==="string"){i[g]=$(h).val()||void 0}if(typeof h==="object"){if(h.element){i[g]=$(h.element).val()||void 0}if(h.get){i[g]=h.get()}}}return this.sendForm(i)};b.prototype.sendForm=function(a){this.$Modal.find(".result").addClass("hidden").end().find(".progress").removeClass("hidden");return this._Service.createOrUpdate(a).then((function(d){return function(c){if(c.id){d.resetList();d.clearFilters()}else{d.updateList()}d.$Modal.modal("hide");return swal(app.localize("Ok"),app.localize("Data saved!"),"success")}})(this)).fail((function(d){return function(e){var c;try{return console.error("ERROR:",e)}catch(h){c=h;return console.log("ERROR:",e)}}})(this)).always((function(d){return function(){return d.$Modal.find(".progress").addClass("hidden").end().find(".result").removeClass("hidden")}})(this))};b.prototype.deleteItem=function(a){return this._Service["delete"]({id:a}).then((function(d){return function(c){d.updateList();return swal("Deleted!","Your imaginary file has been deleted.","success")}})(this)).fail((function(d){return function(e){var c;try{return console.error("ERROR:",e)}catch(h){c=h;return console.log("ERROR:",e)}}})(this))};b.prototype.clearFilters=function(){return this.$filterForm.find(this.sFormClean).val("")};return b})()}).call(this);