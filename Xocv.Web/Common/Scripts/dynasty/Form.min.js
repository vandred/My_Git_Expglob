(function(){window.Form=(function(){function a(b){this._Filters={};this._Table={};this._Service=b.service;this.jtable=b.jtable;this.$Table=$(b.table);this.$filterForm=$(b.filterForm);this.$Modal=$(b.modal);this._FormField=b.formField;this.sFormClean=b.formClean;this.$saveButton=$(b.saveButton)}a.prototype.init=function(b){this.$Table.jtable(this.jtable);return this.getList()};a.prototype.getList=function(){return this.$Table.jtable("load",this._Filters)};a.prototype.resetList=function(){return this.$Table.jtable("load",{})};a.prototype.updateList=function(){return this.$Table.jtable("reload")};a.prototype.getFilters=function(){var b;b={OrganisationUnitId:$("#filterClinicianId").val()||void 0,filterName:$("#filterName").val()||void 0,filterSecurity:$("#filterSecurity").val()||void 0,filterGender:$("#filterGender").val()||void 0,filterLanguage:$("#filterLanguage").val()||void 0,filterPayor:$("#filterPayor").val()||void 0};return Object.assign(this._Filters,b)};a.prototype.fillForm=function(g){var d,f,e,b,c;d=this._Table[g]||{};b=this._FormField;for(f in b){e=b[f];c=d[f];if(typeof e==="string"){$(e).val(c||"")}if(typeof e==="object"){if(e.element){$(e.element).val(c||"")}if(e.set){e.set(c,f,d)}}}return this.$saveButton.find(".btnText").text(app.localize("Save"))};a.prototype.getForm=function(c){var d,f,e,b;d={};b=this._FormField;for(f in b){e=b[f];if(typeof e==="string"){d[f]=$(e).val()||void 0}if(typeof e==="object"){if(e.element){d[f]=$(e.element).val()||void 0}if(e.get){d[f]=e.get()}}}return this.sendForm(d)};a.prototype.sendForm=function(b){this.$Modal.find(".result").addClass("hidden").end().find(".progress").removeClass("hidden");return this._Service.createOrUpdate(b).then((function(c){return function(d){if(d.id){c.resetList();c.clearFilters()}else{c.updateList()}c.$Modal.modal("hide");return swal(app.localize("Ok"),app.localize("Data saved!"),"success")}})(this)).fail((function(c){return function(f){var g;try{return console.error("ERROR:",f)}catch(d){g=d;return console.log("ERROR:",f)}}})(this)).always((function(c){return function(){return c.$Modal.find(".progress").addClass("hidden").end().find(".result").removeClass("hidden")}})(this))};a.prototype.deleteItem=function(b){return this._Service["delete"]({id:b}).then((function(c){return function(d){c.updateList();return swal("Deleted!","Your imaginary file has been deleted.","success")}})(this)).fail((function(c){return function(f){var g;try{return console.error("ERROR:",f)}catch(d){g=d;return console.log("ERROR:",f)}}})(this))};a.prototype.clearFilters=function(){return this.$filterForm.find(this.sFormClean).val("")};return a})()}).call(this);